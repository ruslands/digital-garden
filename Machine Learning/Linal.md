Скалярное произведение векторов можно найти через 2 формулы:

1. Скалярным произведением двух векторов называется ЧИСЛО, равное произведению длин этих векторов на косинус угла между ними:  
a·b = |a|·|b| · cos α

2. Через координаты векторов  
a = {1; 5} и b = {4; 3}.  
a·b = 1 · 4 + 5 · 3 = 4 + 15 = 1

Найдем длину: |a| = sqrt(a_1**2 + a_2**2)  
|a| = √(9 + 16) = √25 =  
|b| = √(16 + 9) = √25 =  

Найдем угол между векторами:  
cos α = a · b / |a| · |b| = 24/25 = 0.9

Python implement

a = np.array([3,4])  
b = np.array([4,3])

scalar = np.dot(a,b) # скалярное произведение векторов

a_len = np.sqrt(a[0]**2 + a[1]**2) # найдем длину вектора (модуль)  
b_len = np.sqrt(b[0]**2 + b[1]**2) # найдем длину вектора (модуль)

cos_a_b = scalar / (a_len * b_len)

def cosine_similarity(a,b):  
    return np.dot(a,b) / (np.sqrt(a[0]**2 + a[1]**2) * np.sqrt(b[0]**2 + b[1]**2))

np.linalg.norm(a-b)**2 # евклидово расстояние, квадрат расстояния

Spark implement cosine similarity

u = Vectors.dense([1,2,3,0,8])  
v = Vectors.dense([3,1,8,5,8])

v.norm(2) # длина вектора  
v.dot(u) # скалярное произведение векторов

cosa = v.dot(u) / v.norm(2) * u.norm(2)